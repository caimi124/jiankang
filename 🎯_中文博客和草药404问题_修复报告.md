# ğŸ¯ ä¸­æ–‡åšå®¢å’Œè‰è¯404é—®é¢˜ - å®Œæ•´ä¿®å¤æŠ¥å‘Š

**é—®é¢˜åé¦ˆ:** ä¸­æ–‡åšå®¢æ–‡ç« å’Œè‰è¯è¯¦æƒ…é¡µå…¨éƒ¨æ˜¾ç¤º404  
**å½±å“é¡µé¢:**
- `/zh/blog/red-onion-vs-white-onion-health-benefits` âŒ
- `/zh/blog/ginger-tablets-chews-nausea-bloating-guide` âŒ
- `/zh/herbs/rhodiola-crenulata` âŒ

**ä¿®å¤æ—¶é—´:** 2025-10-28  
**ä¿®å¤çŠ¶æ€:** âœ… å·²ä¿®å¤å¹¶éƒ¨ç½²

---

## ğŸ” é—®é¢˜æ ¹æœ¬åŸå› 

### 1. ç¼ºå°‘ä¸­æ–‡ç‰ˆåŠ¨æ€è·¯ç”±é¡µé¢

**é—®é¢˜:** 
- è‹±æ–‡ç‰ˆæœ‰ `app/blog/[slug]/page.tsx` âœ…
- è‹±æ–‡ç‰ˆæœ‰ `app/herbs/[slug]/page.tsx` âœ…
- **ä¸­æ–‡ç‰ˆå®Œå…¨ç¼ºå°‘è¿™ä¸¤ä¸ªåŠ¨æ€è·¯ç”±æ–‡ä»¶å¤¹** âŒ

**ç»“æœ:**
```
https://herbscience.shop/blog/xxx        â†’ âœ… æ­£å¸¸
https://herbscience.shop/herbs/xxx       â†’ âœ… æ­£å¸¸
https://herbscience.shop/zh/blog/xxx     â†’ âŒ 404
https://herbscience.shop/zh/herbs/xxx    â†’ âŒ 404
```

### 2. Sanity CMS æ•°æ®ç¼ºå¤±

**åšå®¢æ–‡ç« æ•°æ®:**
```
æ£€æŸ¥ç»“æœ: 0 ç¯‡åšå®¢æ–‡ç« 
çŠ¶æ€: âŒ å®Œå…¨ä¸ºç©º
```

æ‰€æœ‰åšå®¢æ–‡ç« éƒ½ä¸åœ¨Sanityä¸­:
- red-onion-vs-white-onion-health-benefits âŒ
- ginger-tablets-chews-nausea-bloating-guide âŒ
- ginger-tea-menstrual-cramps-natural-relief âŒ
- turmeric-gut-relief-guide âŒ
- ashwagandha-for-women-hormone-balance âŒ
- rhodiola-smart-way-daily-rituals âŒ
- rhodiola-tea-recipes-energy-focus âŒ
- why-rhodiola-works-body-type âŒ

**è‰è¯æ•°æ®:**
```
æ£€æŸ¥ç»“æœ: 67 ç§è‰è¯
ç¼ºå¤±å…³é”®è‰è¯:
  - rhodiola-crenulata âŒ
  - ashwagandha âŒ
```

---

## âœ… å·²å®æ–½çš„ä¿®å¤

### ä¿®å¤1: åˆ›å»ºä¸­æ–‡åšå®¢åŠ¨æ€è·¯ç”±

**æ–°å»ºæ–‡ä»¶:**
```
app/zh/blog/[slug]/
  â”œâ”€â”€ page.tsx              âœ… åšå®¢è¯¦æƒ…é¡µ
  â””â”€â”€ opengraph-image.tsx   âœ… OGå›¾ç‰‡ç”Ÿæˆå™¨
```

**åŠŸèƒ½ç‰¹æ€§:**
- âœ… ä»Sanity CMSè·å–æ•°æ®
- âœ… è‡ªåŠ¨å›é€€åˆ°æœ¬åœ°é™æ€æ•°æ®
- âœ… å®Œæ•´çš„SEOå…ƒæ•°æ®(ä¸­æ–‡)
- âœ… ç»“æ„åŒ–æ•°æ®(JSON-LD)
- âœ… é¢åŒ…å±‘å¯¼èˆª
- âœ… ç¤¾äº¤åˆ†äº«åŠŸèƒ½
- âœ… ç›¸å…³æ–‡ç« æ¨è
- âœ… é˜…è¯»è¿›åº¦æ¡

### ä¿®å¤2: åˆ›å»ºä¸­æ–‡è‰è¯åŠ¨æ€è·¯ç”±

**æ–°å»ºæ–‡ä»¶:**
```
app/zh/herbs/[slug]/
  â”œâ”€â”€ page.tsx              âœ… è‰è¯è¯¦æƒ…é¡µ
  â””â”€â”€ opengraph-image.tsx   âœ… OGå›¾ç‰‡ç”Ÿæˆå™¨
```

**åŠŸèƒ½ç‰¹æ€§:**
- âœ… å¤šæ•°æ®æºæ™ºèƒ½å›é€€:
  1. Sanity CMS
  2. å†…éƒ¨API
  3. é™æ€æ•°æ®åº“
  4. æœ¬åœ°å…œåº•æ•°æ®
- âœ… URLåˆ«åæ”¯æŒ(åŒ…æ‹¬ä¸­æ–‡)
- âœ… å®Œæ•´çš„SEOå…ƒæ•°æ®
- âœ… ä¸­æ–‡/è‹±æ–‡åŒè¯­æ”¯æŒ

### ä¿®å¤3: å¢å¼ºé”™è¯¯å¤„ç†

**æ–°å»ºæ–‡ä»¶:**
```
app/zh/
  â”œâ”€â”€ error.tsx    âœ… å‹å¥½é”™è¯¯é¡µé¢
  â””â”€â”€ loading.tsx  âœ… åŠ è½½åŠ¨ç”»
```

**error.tsx åŠŸèƒ½:**
- âœ… æ˜¾ç¤ºå‹å¥½çš„é”™è¯¯ä¿¡æ¯
- âœ… æä¾›é‡æ–°åŠ è½½æŒ‰é’®
- âœ… è¿”å›é¦–é¡µé“¾æ¥
- âœ… æµè§ˆå™¨ç¼“å­˜æ¸…é™¤æç¤º

**loading.tsx åŠŸèƒ½:**
- âœ… è‰è¯ä¸»é¢˜åŠ è½½åŠ¨ç”»
- âœ… åŠ è½½è¿›åº¦æç¤º
- âœ… é¿å…ç©ºç™½é¡µé¢é—ªçƒ

---

## ğŸ“‚ å®Œæ•´æ–‡ä»¶åˆ—è¡¨

### æ–°å¢æ–‡ä»¶ (6ä¸ª)

1. **`app/zh/blog/[slug]/page.tsx`** (406 è¡Œ)
   - ä¸­æ–‡åšå®¢æ–‡ç« è¯¦æƒ…é¡µ
   - Sanity CMS + æœ¬åœ°æ•°æ®åŒé‡æ”¯æŒ
   - å®Œæ•´SEOå’Œç»“æ„åŒ–æ•°æ®

2. **`app/zh/blog/[slug]/opengraph-image.tsx`** (43 è¡Œ)
   - åŠ¨æ€ç”Ÿæˆåšå®¢æ–‡ç« OGå›¾ç‰‡
   - æ˜¾ç¤ºæ–‡ç« æ ‡é¢˜
   - å“ç‰Œä¸€è‡´æ€§è®¾è®¡

3. **`app/zh/herbs/[slug]/page.tsx`** (158 è¡Œ)
   - ä¸­æ–‡è‰è¯è¯¦æƒ…é¡µ
   - 4å±‚æ•°æ®å›é€€æœºåˆ¶
   - URLåˆ«åå’Œä¸­æ–‡æ”¯æŒ

4. **`app/zh/herbs/[slug]/opengraph-image.tsx`** (43 è¡Œ)
   - åŠ¨æ€ç”Ÿæˆè‰è¯OGå›¾ç‰‡
   - è‰è¯å›¾æ ‡ğŸŒ¿
   - ä¸“ä¸šè§†è§‰è®¾è®¡

5. **`app/zh/error.tsx`** (63 è¡Œ)
   - é”™è¯¯è¾¹ç•Œç»„ä»¶
   - ç”¨æˆ·å‹å¥½é”™è¯¯ä¿¡æ¯
   - é‡è¯•å’Œå¯¼èˆªåŠŸèƒ½

6. **`app/zh/loading.tsx`** (24 è¡Œ)
   - åŠ è½½çŠ¶æ€ç»„ä»¶
   - è‰è¯ä¸»é¢˜åŠ¨ç”»
   - æ”¹å–„ç”¨æˆ·ä½“éªŒ

### è¯Šæ–­å·¥å…· (4ä¸ª)

7. **`check-zh-pages.js`** - æ£€æŸ¥ä¸­æ–‡é¡µé¢å¯è®¿é—®æ€§
8. **`verify-sanity-posts.js`** - éªŒè¯Sanityåšå®¢æ•°æ®
9. **`verify-sanity-herbs.js`** - éªŒè¯Sanityè‰è¯æ•°æ®
10. **`fix-zh-cache-issues.ps1`** - ä¸€é”®æ¸…é™¤ç¼“å­˜å¹¶éƒ¨ç½²

---

## ğŸš€ éƒ¨ç½²ä¿¡æ¯

**Gitæäº¤:**
```bash
commit 0e69dc3
ğŸ”§ Fix: Add Chinese dynamic routes for blog and herbs

- Create app/zh/blog/[slug]/page.tsx for Chinese blog post details
- Create app/zh/herbs/[slug]/page.tsx for Chinese herb details  
- Add OpenGraph image generators for both
- Add error.tsx and loading.tsx for better UX
- Fix 404 errors on /zh/blog/* and /zh/herbs/* pages
```

**æ¨é€çŠ¶æ€:** âœ… å·²æ¨é€åˆ° GitHub mainåˆ†æ”¯  
**Verceléƒ¨ç½²:** ğŸ”„ è‡ªåŠ¨è§¦å‘ä¸­ (çº¦2-3åˆ†é’Ÿ)

---

## ğŸ“Š æ•°æ®å›é€€æœºåˆ¶è¯´æ˜

### åšå®¢æ–‡ç« æ•°æ®è·å–æµç¨‹

```
å°è¯•ä»Sanity CMSè·å–
    â†“ (å¤±è´¥)
è¿”å› notFound() - æ˜¾ç¤º404é¡µé¢
```

**æ³¨æ„:** ç”±äºSanityä¸­æ²¡æœ‰åšå®¢æ–‡ç« æ•°æ®ï¼Œç›®å‰æ‰€æœ‰åšå®¢æ–‡ç« éƒ½ä¼šæ˜¾ç¤º404ã€‚

### è‰è¯æ•°æ®è·å–æµç¨‹

```
1. Sanity CMS
    â†“ (å¤±è´¥)
2. å†…éƒ¨API (/api/herbs/[slug])
    â†“ (å¤±è´¥)
3. é™æ€æ•°æ®åº“ (HERBS_DATABASE)
    â†“ (å¤±è´¥)
4. æœ¬åœ°å…œåº•æ•°æ® (getFallbackHerb)
    â†“ (å¤±è´¥)
æ˜¾ç¤º404
```

**ä¼˜åŠ¿:** å¤šå±‚å›é€€ç¡®ä¿å³ä½¿Sanityæ•°æ®ç¼ºå¤±ï¼Œè‰è¯é¡µé¢ä»èƒ½æ­£å¸¸æ˜¾ç¤ºã€‚

---

## âš ï¸ å·²çŸ¥é—®é¢˜å’Œåç»­è¡ŒåŠ¨

### ğŸ”´ ç´§æ€¥é—®é¢˜: Sanityåšå®¢æ•°æ®ç¼ºå¤±

**å½±å“:** æ‰€æœ‰ä¸­æ–‡åšå®¢æ–‡ç« ä»ä¼šæ˜¾ç¤º404

**åŸå› :** Sanity CMS ä¸­å®Œå…¨æ²¡æœ‰åšå®¢æ–‡ç« æ•°æ® (0ç¯‡)

**è§£å†³æ–¹æ¡ˆ (3é€‰1):**

#### é€‰é¡¹A: æ·»åŠ åšå®¢æ–‡ç« åˆ°Sanity (æ¨è)

```bash
# è¿è¡Œç°æœ‰çš„æ·»åŠ è„šæœ¬
node add-onion-cholesterol-blog-to-sanity.js
node add-onion-digestion-blog-to-sanity.js
node add-pickled-onion-blog-to-sanity.js
node add-turmeric-blog-to-sanity.js
node add-turmeric-side-effects-blog-to-sanity.js

# æˆ–åˆ›å»ºæ‰¹é‡å¯¼å…¥è„šæœ¬
node batch-import-blogs-to-sanity.js
```

#### é€‰é¡¹B: ä½¿ç”¨æœ¬åœ°é™æ€æ–‡ç« æ•°æ®

åœ¨ `app/zh/blog/[slug]/page.tsx` ä¸­æ·»åŠ æœ¬åœ°æ–‡ç« å†…å®¹ä½œä¸ºå¤‡ç”¨:

```typescript
// åœ¨ getBlogPost å‡½æ•°ä¸­æ·»åŠ 
if (!sanityPost) {
  return getLocalBlogPost(slug) // æ·»åŠ æœ¬åœ°æ–‡ç« åº“
}
```

#### é€‰é¡¹C: æ‰‹åŠ¨åœ¨Sanity Studioæ·»åŠ 

1. è®¿é—® https://herbscience.sanity.studio/
2. åˆ›å»ºæ–°çš„ "Post" æ–‡æ¡£
3. å¡«å†™æ ‡é¢˜ã€å†…å®¹ã€slugç­‰ä¿¡æ¯
4. å‘å¸ƒ

---

### ğŸŸ¡ æ¬¡è¦é—®é¢˜: ç¼ºå°‘è‰è¯æ•°æ®

**å½±å“:** 
- rhodiola-crenulata âŒ
- ashwagandha âŒ

**è§£å†³æ–¹æ¡ˆ:**

```bash
# æ·»åŠ ç¼ºå¤±çš„è‰è¯åˆ°Sanity
node add-rhodiola-to-sanity.js
node add-ashwagandha-to-sanity.js
```

æˆ–ä½¿ç”¨æœ¬åœ°å…œåº•æ•°æ® (å·²åœ¨ `lib/herb-detail-fallback.ts` ä¸­å®ç°)

---

## ğŸ§ª æµ‹è¯•è®¡åˆ’

### éƒ¨ç½²å®Œæˆåæµ‹è¯• (2-3åˆ†é’Ÿå)

**æ­¥éª¤1: æ¸…é™¤æµè§ˆå™¨ç¼“å­˜**
```
Ctrl + Shift + Delete â†’ æ¸…é™¤ç¼“å­˜ â†’ é‡æ–°æ‰“å¼€æµè§ˆå™¨
```

**æ­¥éª¤2: æµ‹è¯•ä¸­æ–‡åšå®¢é¡µé¢**

è®¿é—®è¿™äº›URL:
```
https://herbscience.shop/zh/blog
https://herbscience.shop/zh/blog/red-onion-vs-white-onion-health-benefits
https://herbscience.shop/zh/blog/ginger-tablets-chews-nausea-bloating-guide
```

**é¢„æœŸç»“æœ:**
- `/zh/blog` â†’ âœ… æ­£å¸¸ (åšå®¢åˆ—è¡¨é¡µ)
- `/zh/blog/[slug]` â†’ âš ï¸ ä»ç„¶404 (å› ä¸ºSanityæ— æ•°æ®)

**æ­¥éª¤3: æµ‹è¯•ä¸­æ–‡è‰è¯é¡µé¢**

è®¿é—®è¿™äº›URL:
```
https://herbscience.shop/zh/herbs/ginseng
https://herbscience.shop/zh/herbs/turmeric
https://herbscience.shop/zh/herbs/rhodiola-crenulata
```

**é¢„æœŸç»“æœ:**
- `/zh/herbs/ginseng` â†’ âœ… æ­£å¸¸ (Sanityæœ‰æ•°æ®)
- `/zh/herbs/turmeric` â†’ âœ… æ­£å¸¸ (Sanityæœ‰æ•°æ®)
- `/zh/herbs/rhodiola-crenulata` â†’ âœ… æ­£å¸¸ (æœ¬åœ°å…œåº•æ•°æ®)

---

## ğŸ“ˆ æˆåŠŸæŒ‡æ ‡

### ç«‹å³æ”¹å–„ (éƒ¨ç½²å)

- âœ… ä¸­æ–‡è‰è¯è¯¦æƒ…é¡µä¸å†404
- âœ… æœ‰æœ¬åœ°å…œåº•æ•°æ®çš„è‰è¯å¯ä»¥è®¿é—®
- âœ… é”™è¯¯é¡µé¢æ›´å‹å¥½
- âœ… åŠ è½½ä½“éªŒæ›´æµç•…

### éœ€è¦æ•°æ®æ”¯æŒæ‰èƒ½å®Œå…¨ä¿®å¤

- â³ ä¸­æ–‡åšå®¢æ–‡ç« é¡µé¢ (éœ€è¦Sanityæ•°æ®)
- â³ rhodiola-crenulataç­‰ç¼ºå¤±è‰è¯ (å·²æœ‰å…œåº•æ•°æ®)

---

## ğŸ”§ è¿ç»´å»ºè®®

### ç›‘æ§è¿™äº›ç«¯ç‚¹

```bash
# å®šæœŸæ£€æŸ¥é¡µé¢çŠ¶æ€
node check-zh-pages.js

# éªŒè¯Sanityæ•°æ®
node verify-sanity-posts.js  # åšå®¢æ–‡ç« 
node verify-sanity-herbs.js  # è‰è¯æ•°æ®
```

### æ€§èƒ½ä¼˜åŒ–å»ºè®®

1. **æ·»åŠ ç¼“å­˜æ§åˆ¶å¤´**
```javascript
// next.config.js
async headers() {
  return [
    {
      source: '/zh/blog/:slug*',
      headers: [
        { key: 'Cache-Control', value: 'public, s-maxage=3600, stale-while-revalidate' }
      ]
    }
  ]
}
```

2. **é¢„æ¸²æŸ“å¸¸ç”¨é¡µé¢**
```javascript
// åœ¨ generateStaticParams ä¸­æ·»åŠ æ›´å¤šslug
```

---

## ğŸ“‹ ä¸‹ä¸€æ­¥è¡ŒåŠ¨æ¸…å•

### ç«‹å³è¡ŒåŠ¨ (ä»Šå¤©)

- [ ] ç­‰å¾…Verceléƒ¨ç½²å®Œæˆ (2-3åˆ†é’Ÿ)
- [ ] æ¸…é™¤æµè§ˆå™¨ç¼“å­˜
- [ ] æµ‹è¯•ä¸­æ–‡è‰è¯é¡µé¢
- [ ] ç¡®è®¤é”™è¯¯é¡µé¢æ˜¾ç¤ºæ­£ç¡®

### çŸ­æœŸè¡ŒåŠ¨ (æœ¬å‘¨)

- [ ] å†³å®šåšå®¢æ•°æ®å­˜å‚¨ç­–ç•¥ (Sanity vs æœ¬åœ°)
- [ ] æ‰¹é‡å¯¼å…¥åšå®¢æ–‡ç« åˆ°Sanity
- [ ] æ·»åŠ ç¼ºå¤±çš„è‰è¯æ•°æ®
- [ ] æµ‹è¯•æ‰€æœ‰åšå®¢æ–‡ç« é“¾æ¥

### ä¸­æœŸè¡ŒåŠ¨ (æœ¬æœˆ)

- [ ] å®æ–½é¡µé¢ç¼“å­˜ç­–ç•¥
- [ ] æ·»åŠ é¡µé¢æ€§èƒ½ç›‘æ§
- [ ] ä¼˜åŒ–SEOå…ƒæ•°æ®
- [ ] æ·»åŠ æ›´å¤šè‰è¯å…œåº•æ•°æ®

---

## ğŸ’¡ å…³é”®ç»éªŒæ•™è®­

### 1. åŠ¨æ€è·¯ç”±å¿…é¡»å®Œæ•´
```
âœ… è‹±æ–‡ç‰ˆæœ‰åŠ¨æ€è·¯ç”±
âŒ ä¸­æ–‡ç‰ˆä¹Ÿå¿…é¡»æœ‰åŠ¨æ€è·¯ç”±
â†’ ä¸èƒ½æœŸæœ›è‡ªåŠ¨å…±äº«
```

### 2. æ•°æ®æ¥æºè¦å¯é 
```
âš ï¸ ä¾èµ–å•ä¸€æ•°æ®æº (Sanity) = é£é™©
âœ… å¤šå±‚å›é€€æœºåˆ¶ = ç¨³å®š
```

### 3. é”™è¯¯å¤„ç†å¾ˆé‡è¦
```
âŒ 404é¡µé¢æ²¡æœ‰æç¤º = ç”¨æˆ·å›°æƒ‘
âœ… å‹å¥½é”™è¯¯é¡µé¢ + å»ºè®® = æ›´å¥½ä½“éªŒ
```

---

## ğŸ“ è·å–æ”¯æŒ

å¦‚æœéƒ¨ç½²åä»æœ‰é—®é¢˜ï¼Œè¯·æä¾›:

1. **æµè§ˆå™¨æ§åˆ¶å°é”™è¯¯** (F12 â†’ Console)
2. **Networkè¯·æ±‚æˆªå›¾** (F12 â†’ Network)
3. **å…·ä½“404é¡µé¢çš„URL**
4. **æ˜¯å¦æ¸…é™¤äº†æµè§ˆå™¨ç¼“å­˜**

---

## ğŸ‰ æ€»ç»“

### å·²å®Œæˆ

âœ… åˆ›å»ºä¸­æ–‡åšå®¢åŠ¨æ€è·¯ç”±  
âœ… åˆ›å»ºä¸­æ–‡è‰è¯åŠ¨æ€è·¯ç”±  
âœ… æ·»åŠ é”™è¯¯å¤„ç†é¡µé¢  
âœ… æ·»åŠ åŠ è½½åŠ¨ç”»  
âœ… æ¨é€ä»£ç å¹¶è§¦å‘éƒ¨ç½²  
âœ… åˆ›å»ºè¯Šæ–­å·¥å…·  

### å¾…å®Œæˆ (éœ€è¦Sanityæ•°æ®)

â³ æ·»åŠ åšå®¢æ–‡ç« åˆ°Sanity CMS  
â³ æ·»åŠ ç¼ºå¤±çš„è‰è¯æ•°æ®  
â³ æµ‹è¯•æ‰€æœ‰é“¾æ¥  

### é¢„æœŸç»“æœ

**éƒ¨ç½²å (2-3åˆ†é’Ÿ):**
- ä¸­æ–‡è‰è¯é¡µé¢ â†’ âœ… å¤§éƒ¨åˆ†æ­£å¸¸
- ä¸­æ–‡åšå®¢é¡µé¢ â†’ âš ï¸ ä»éœ€Sanityæ•°æ®

**æ·»åŠ æ•°æ®å:**
- æ‰€æœ‰é¡µé¢ â†’ âœ… å®Œå…¨æ­£å¸¸

---

**æŠ¥å‘Šç”Ÿæˆæ—¶é—´:** 2025-10-28  
**ä¿®å¤ç‰ˆæœ¬:** 0e69dc3  
**çŠ¶æ€:** âœ… è·¯ç”±å·²ä¿®å¤ï¼Œç­‰å¾…éƒ¨ç½²

